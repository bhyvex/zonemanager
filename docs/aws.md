# Amazon Route53

First, buy or move your domain to Amazon Route53, create hosted zone for it and note its ID.

Install `awscli` AWS command line tool:

```
/opt/farm/scripts/setup/extension.sh sf-cloud-client-ec2
aws configure --profile default
```

Now you can create public zone files. You can do it either manually, or using this script:

```
/opt/zonemaster/scripts/aws/scan-zone.php default Z25SD356N45NLE >/etc/local/.dns/yourdomain.com
```

It scans the current configuration of your domain record sets and generates the zone
file, which could be later edited and fine-tuned manually.

## Why 2 separate files?

`/etc/local/.dns/zone.public` holds all "static", manually updated entries

`/etc/local/.dns/zone.public-yourdomain.com` holds only "dynamic", automatically updated
entries and is meant to be periodically regenerated by some external tool, eg. when new
Amazon EC2 instance is created.

Example `/etc/local/.dns/zone.public` file:

```
# basic domain configuration (static entries)
mx.yourdomain.com                        A        52.35.36.25
```

Example `/etc/local/.dns/zone.public-yourdomain.com` file:

```
# this file contains frequently changed entries
dynamic.yourdomain.com                   CNAME    ec2-52-10-70-178.us-west-2.compute.amazonaws.com
dynamic2.yourdomain.com                  CNAME    ec2-52-35-36-25.us-west-2.compute.amazonaws.com
dynamic3.yourdomain.com                  CNAME    ec2-52-34-55-16.us-west-2.compute.amazonaws.com
```

Finally, after you do any required manual arrangements to your zone files, add this
script to your crontab:

```
/opt/zonemaster/scripts/aws/cron.sh default yourdomain.com Z25SD356N45NLE
```
